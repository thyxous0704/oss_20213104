
# 오픈소스SW개론

---

### 리눅스 명령어 top

1. 시스템의 상태를 전반적으로 빠르게 파악 가능(CPU, Memory, Process)
  
2. 옵션 없이 입력하면 일정 간격(기본 3초)으로 화면을 갱신하며 정보를 보여줌
  
  <img src="https://user-images.githubusercontent.com/106811802/172003241-dd4034ad-0d0b-4d4d-8891-106991932fe8.png" width="80%" height="80%">

3. top 정보 시스템 내용
* 첫 번째 줄 : 서버 정보를 담고 있는 줄

|||
|---|---|
|21:07:37|시스템 현재 시간|
|Up 1days, 2:58|uptime(켜져 있는 시간)|
|0users|0명의 사용자가 접속|
|load average|0.07, 0.02, 0.03 최근 1분, 5분, 15분 각각의 시스템 평균 부하율|

* 두 번째 줄 : 프로세스 정보를 담고 있는 줄

|||
|---|---|
|10 total|전체 실행된 프로세스 수|
|1 running|현재 실행된 프로세스 수|
|9 sleeping|대기 중인 프로세스 수|
|0 stopped|멈춘 프로세스 수|
|0 zombie|좀비 프로세스 수|

* 세 번째 줄 : CPU 정보를 담고 있는 줄

|||
|---|---|
|%us|사용자가 실행시킨 프로세스의 CPU 사용률|
|%sy|시스템 자체에서 사용하는 CPU 사용률|
|%ni|noce정책에 의해 사용되고 있는 CPU 사용률|
|%id|사용되지 않고 남은 CPU 사용률|
|%wa|입출력 대기상태의 CPU 사용률|
|%hi|IRQs에 사용된 CPU|
|%si|softIRZs에 사용된 CPU|
|%st|steal 값(ekfms instansces 실행에 주어진 time 값)|

* 네 번째와 다섯 번째 줄 : 메모리 정보를 담고 있는 줄

|MiB Mem||
|---|---|
|total|전체 물리적인 메모리|
|free|사용되지 않은 여유 메모리|
|used|사용 중인 메모리|
|buff/cache|버퍼된 메모리|

|Swap||
|---|---|
|total|전체 스왑 메모리|
|free|사용되지 않은 여유 메모리|
|used|사용 중인 스왑 메모리|
|avail Mem|캐싱 메모리|

* 여섯 번째 줄 : 전체 개별 프로세스들의 시스템 자원 사용현황과 실행상태를 담고 있는 줄

|||
|---|---|
|PID|프로세스ID|
|USER|프로세스를 실행시킨 사용자 ID|
|PR|프로세스의 우선순위|
|NI|NICE 값, 마이너스(-)면 우선순위 높은 일(0값은 우선순위 적용되지 않음)|
|VIRT|해당 프로세스가 사용한 가상 메모리의 총량|
|RES|해당 프로세스의 물리적인 메모리 사용량|
|SHR|해당 프로세스에 의해 사용된 공유메모리의 총량|
|S|해당 프로세스의 상태를 나타내며 다음 중 하나의 값을 가진다.</br>D = 중단될 수 없는 Sleep 상태의 프로세스</br>R = 실행 중인 프로세스(running)</br>S = 휴면 상태의 프로세스(sleeping)</br>T = trace되거나 스톱된 프로세스</br>Z = 좀비프로세스|
|%CPU|해당 프로세스의 CPU 사용률|
|%MEM|프로세스가 사용하는 메모리의 사용률|
|TIME+|100분의 1초 단위로 반영하는 CPU 사용시간 값을 나타냄|
|COMMAND|실행된 명령어|

4. top 실행 전 옵션
* -b : 배치모드 옵션
* -n : top 실행 주기를 설정
* -p : process ID

5. top 실행 후 명령어
* shift + p : CPU 사용률 내림차순
* shift + m : 메모리 사용률 내림차순
* shift + t : 프로세스가 돌아가고 있는 시간 순
* k : 프로세스를 종료시킨다
* a : 메모리 사용량에 따라 정렬
* b : batch 모드로 작동
* q : top을 종료

---

### 리눅스 명령어 ps

1. 현재 실행 중인 프로세스 목록과 상태를 보여줌. 주로 파이프라인, grep 명령어와 함께 사용하여 특정 프로세스를 확인하는데 많이 사용됨.
2. 사용법 : ps [option]
3. ps 주요 옵션(리눅스 버전에 따라 옵션이 차이가 있을 수 있음)

|||
|---|---|
|-e|모든 프로세스 출력|
|-f|풀 포맷으로 보여줌|
|-l|긴 포맷으로 보여줌|
|p, -p|특정 PID의 프로세스를 보여줌|
|-u|특정 사용자의 프로세스를 보여줌|

4. ps로 알 수 있는 대표적인 정보

|||
|---|---|
|UID|SYSTEM V 계열에서 나타나는 항목으로 프로세스 소유자의 이름|
|PID|프로세스의 식별번호|
|PPID|부모 프로세스 ID|
|C, CP|짧은 기간 동안의 CPU 사용률(C:Sys V, CP:BSD)|
|STIME|프로세스가 시작된 시간 혹은 날짜|
|TTY|프로세스와 연결된 터미널|
|TIME|총 CPU 사용 시간|
|COMMAND|프로세스의 실행 명령행|

5. ps와 top의 차이점
* ps는 ps 한 시점에 proc에서 검색한 CPU 사용량
* top은 proc에서 일정 주기로 합산해 CPU 사용률 출력

---

### 리눅스 명령어 jobs

1. 작업이 중지된 상태나 백그라운드로 진행 중인 상태를 표시
2. 현재 쉘 세션에서 실행시킨 백그라운드 직업의 목록이 출력되며, 각 작업에는 번호가 붙어 있어 kill 명령어 뒤에 '%번호' 등으로 사용할 수 있음
3. 사용법 : jobs [option] [job ID]
4. 옵션

|||
|---|---|
|-ㅣ|프로세스 그룹 ID를 state 필드 앞에 출력|
|-n|프로세스 그룹 중에 대표 프로세스 ID를 출력|
|-p|각 프로세스 ID에 대한 한 행씩 출력|
|command|지정한 명령어를 실행|

5. jobs로 알 수 있는 세션의 상태 값

|||
|---|---|
|Running|작업이 계속 진행 중임|
|Done|작업이 완료되어 0을 반환하고 종료했음을 의미|
|Done(code)|작업이 정상적으로 완료되었으며, 0이 아닌 코드를 반환했음을 의미|
|Stopped|작업이 일시 중단|
|Stopped(SIGTSTP)|SIGTSTP 신호가 작업을 일시 중단|
|Stopped(SIGSTOP)|SIGSTOP 신호가 작업을 일시 중단| 
|Stopped(SIGTTIN)|SIGTTIN 신호가 작업을 일시 중단|
|Stopped(SIGTTOU)|SIGTTOU 신호가 작업을 일시 중단|

---

### 리눅스 명령어 kill

1. 프로세스에 시그널을 보내 원하는 작업을 하게 하는 명령어. 대게 프로세스를 죽일 때 사용
2. 사용법 : kill [option] <pid>
3. 주요 시그널(kill -l을 통해 지원하는 시그널 목록 확인 가능)

|시그널|영어|설명|
|---|---|---|
|1) SIGHUP|Hang Up|세션이 종료될 때 시스템이 내리는 시그널|
|2) SIGINT|Interrupt|Ctrl + C, 종료 요청 시그널|
|9) SIGKILL|Kill|강제 종료 시그널|
|11) SIGSEGV|Segment Violation|메모리 침범이 일어날 때 시스템이 보내는 시그널|
|15) SIGTERM|Terminate|기본 값, 종료 요청 시그널|
|20) SIGTSTP| Temporary Stop|Ctrl + Z, 일시 중지 요청 시그널|
  
---
  
### vim 매크로 사용법

1. 매크로 기록
* vim의 명령모드에서 q를 누른 다음 매크로 이름으로 사용할 알파벳을 하나 눌러준다(이해하기 쉽게 매크로명이라고 했으나 정확히는 매크로가 저장될 register 주소로 a~z 사용 가능).
* ex) qa라고 누르면 a라는 이름의 매크로를 기록하기 시작한다(하단에 --recording--이라고 뜬다).
* 기록이 끝났다면 다시 명령모드에서 q를 눌러준다.
* 정리: q[name] -> (매크로 입력) -> q
  
2. 매크로 실행
* vim의 명령모드에서 @를 누른 다음 기록했던 이름인 알파벳을 누르면 해당 매크로가 재생된다. -> @[name]
* 여기서 @[name]을 입력하기 전에 숫자를 입력하면 입력한 숫자만큼 매크로를 실행하게 된다. -> [숫자]@[name]
3. 매크로 편집
* "Ap : 현재 커서 위치에 기록된 매크로 내용 표시
* "Ayy : 출력된 매크로 내용에서 작업 수정/추가 등을 한 후 편집한 내용을 다시 등록
4. 매크로 저장
* 작성한 매크로를 저장해서 계속 재사용하고 싶다면, 현재 편집 중인 내용을 저장 후 ~/.vimrc 파일을 연다(:e 또는 :r).
* 매크로 이름을 b라고 짓고 싶다면 insert모드로 전환 후 let @b='까지 친 다음에 Ctrl+r Ctrl+r <b(마지막으로 사용한 매크로 문자)>를 누르면 매크로의 내용물이 입력된다. 내용물이 입력되었다면 '를 마저 닫아준다.
* ex) let @b='f$a((<End>))<Esc>,<Del>'
